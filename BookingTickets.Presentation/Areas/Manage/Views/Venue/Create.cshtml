@model VenueCreateDto

<div class="container">
    <div class="row">
        <form method="post" enctype="multipart/form-data">
            <div class="form-group">
                <label asp-for="Name"></label>
                <input asp-for="Name" class="form-control">
                <span class="text-danger" asp-validation-for="Name"></span>
            </div>

            <div class="form-group">
                <label asp-for="Address"></label>
                <input asp-for="Address" class="form-control" id="address">
                <span class="text-danger" asp-validation-for="Address"></span>
            </div>

            <button type="button" class="btn btn-success" onclick="getCoordinates()">Koordinatları Tap</button>

            <div class="form-group">
                <label asp-for="Latitude"></label>
                <input asp-for="Latitude" class="form-control" id="latitude" name="Latitude" readonly>
            </div>

            <div class="form-group">
                <label asp-for="Longitude"></label>
                <input asp-for="Longitude" class="form-control" id="longitude" name="Longitude" readonly>
            </div>

            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
</div>

@section scripts {
    @await Html.PartialAsync("_ValidationPartial")

    <script>
        function getCoordinates() {
            var address = document.getElementById("address").value;
            var url = `https://photon.komoot.io/api/?q=${encodeURIComponent(address + ', Baku, Azerbaijan')}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.features.length > 0) {
                        var lat = data.features[0].geometry.coordinates[1]; // Latitude
                        var lon = data.features[0].geometry.coordinates[0]; // Longitude

                        // Koordinatları input sahələrinə yazırıq
                        document.getElementById("latitude").value = lat;
                        document.getElementById("longitude").value = lon;

                    } else {
                        alert("Koordinatlar tapılmadı. Düzgün ünvan daxil etdiyinizə əmin olun.");
                    }
                })
                .catch(error => console.error("Xəta:", error));
        }
    </script>
}
